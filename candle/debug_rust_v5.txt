   Compiling soprano-candle v0.1.0 (D:\soprano\candle)
warning: unused variable: `b`
   --> src\vocos.rs:454:10
    |
454 |     let (b, c, t) = x.dims3()?;
    |          ^ help: if this is intentional, prefix it with an underscore: `_b`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `c`
   --> src\vocos.rs:454:13
    |
454 |     let (b, c, t) = x.dims3()?;
    |             ^ help: if this is intentional, prefix it with an underscore: `_c`

warning: unused variable: `hidden_dim`
   --> src\main.rs:220:9
    |
220 |     let hidden_dim = generated_hidden_states[0].dim(0)?;
    |         ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_hidden_dim`

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:287:8
    |
161 | impl Attention {
    | -------------- method in this implementation
...
287 |     fn clear_kv_cache(&mut self) {
    |        ^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:334:8
    |
300 | impl DecoderLayer {
    | ----------------- method in this implementation
...
334 |     fn clear_kv_cache(&mut self) {
    |        ^^^^^^^^^^^^^^

warning: field `sliding_window` is never read
   --> src\qwen.rs:344:5
    |
340 | pub struct Model {
    |            ----- field in this struct
...
344 |     sliding_window: usize,
    |     ^^^^^^^^^^^^^^
    |
    = note: `Model` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:431:12
    |
349 | impl Model {
    | ---------- method in this implementation
...
431 |     pub fn clear_kv_cache(&mut self) {
    |            ^^^^^^^^^^^^^^

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:474:12
    |
444 | impl ModelForCausalLM {
    | --------------------- method in this implementation
...
474 |     pub fn clear_kv_cache(&mut self) {
    |            ^^^^^^^^^^^^^^

warning: `soprano-candle` (bin "soprano-candle") generated 8 warnings
    Finished `release` profile [optimized] target(s) in 36.38s
     Running `target\release\soprano-candle.exe --prompt "hello world!"`
Using device: Cpu
Loading tokenizer...
Loading Qwen model...
Loading Vocos model...
Generating tokens...
Prompt tokens: [3, 1, 8077, 8070, 8045, 8004, 8053, 8076, 8139, 8005, 2]
Generating tokens (this may take a while)...
DEBUG: Hidden states shape: [1, 11, 512]
DEBUG: Hidden states at last position (first 10): [-0.23600166, 0.95291877, -0.27345368, -0.38878685, -0.4340747, -1.2991865, 0.5617781, 0.6938202, -0.03743372, -0.5303086]
DEBUG: Hidden states range: [-8.0287, 9.2031]
Extracting audio codes...
Decoding audio...
DEBUG_RUST_INPUT shape: [1, 512, 256]
DEBUG_RUST_INPUT tail: [-0.75414664, -0.76288563, -0.7737637, -0.76331025, -0.76540834, -0.75996476, -0.7667503, -0.77700704, -0.7895857, -0.77538013]
DEBUG_RUST_INTERP shape: [1, 512, 1021]
DEBUG_RUST_INTERP tail: [-0.77444285, -0.77700704, -0.7801517, -0.78329635, -0.7864411, -0.7895857, -0.78603435, -0.7824829, -0.7789315, -0.77538013]
DEBUG_RUST_BACKBONE shape: [1, 512, 1021]
DEBUG_RUST_BACKBONE head: [0.26026312, -0.75491583, -0.085165724, -0.4721413, -1.3269749, -1.3452022, -0.68590987, 0.82964164, -0.31978378, 0.64190197]
DEBUG_RUST_BACKBONE tail: [0.11685922, 0.11917843, 0.12090811, 0.10807794, 0.090418085, 0.090207994, 0.038428552, 0.012539715, 0.2641135, -0.297537]
DEBUG_RUST_MAG shape: [1, 1025, 1021]
DEBUG_RUST_MAG head: [1.2432352, 1.1694974, 1.4472722, 1.20428, 1.3526126, 1.3007929, 1.2024612, 0.8009193, 0.55949175, 0.8564234]
DEBUG_RUST_MAG tail: [1.2913479, 1.2915115, 1.2900287, 1.2887921, 1.2920678, 1.3029348, 1.3162102, 1.287116, 1.3039479, 1.3647813]
DEBUG_RUST_PHASE shape: [1, 1025, 1021]
DEBUG_RUST_PHASE head: [0.21145707, 0.26359865, 0.52734774, 0.2744376, 0.44304392, 0.41845843, 0.22358486, 0.32339698, 0.5076186, 0.15076175]
DEBUG_RUST_PHASE tail: [0.6165753, 0.6169901, 0.61260957, 0.614225, 0.6080469, 0.61768335, 0.6073639, 0.5891209, 0.57810056, 0.41044828]
DEBUG_RUST_IRFFT_FRAME0_SCALED head: [0.000103667626, 0.00013977462, 0.00018691432, 8.501658e-5, 0.00015379261, 0.00019462834, 0.0002464394, 0.0001826433, 0.00014218505, 0.00014060084]
DEBUG_RUST_IRFFT_FRAME0_SCALED tail: [0.00017338603, 0.00019241095, 0.00022059627, 0.00020787034, 7.704567e-5, 0.00016725638, 0.00019163264, 5.670268e-5, 0.00014808179, 8.494349e-5]
DEBUG_RUST_FINAL_AUDIO shape: [522240]
DEBUG_RUST_FINAL_AUDIO head: [-0.00015785721, -0.00015902046, -0.00017277231, -0.00014757698, -0.00016982491, -0.00016400676, -0.00016297455, -0.0001548027, -0.00015961808, -0.00015260457]
DEBUG_RUST_FINAL_AUDIO tail: [-0.057724975, 0.0063402895, 0.0100720255, 0.0014842761, 0.029281767, 0.0030002238, -0.051833987, -0.0156723, 0.06649329, -0.023975914]
Audio stats: len=522240, min=-0.3296, max=0.3635
Generated tokens: [7392, 4619, 7468, 6971, 4722, 4730, 4730, 6971, 7297, 7233, 6978, 6913, 6913, 6848, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168, 7168]
Saving to output.wav...
Done!
