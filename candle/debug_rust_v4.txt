   Compiling soprano-candle v0.1.0 (D:\soprano\candle)
warning: unused variable: `b`
   --> src\vocos.rs:454:10
    |
454 |     let (b, c, t) = x.dims3()?;
    |          ^ help: if this is intentional, prefix it with an underscore: `_b`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `c`
   --> src\vocos.rs:454:13
    |
454 |     let (b, c, t) = x.dims3()?;
    |             ^ help: if this is intentional, prefix it with an underscore: `_c`

warning: unused variable: `hidden_dim`
   --> src\main.rs:220:9
    |
220 |     let hidden_dim = generated_hidden_states[0].dim(0)?;
    |         ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_hidden_dim`

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:287:8
    |
161 | impl Attention {
    | -------------- method in this implementation
...
287 |     fn clear_kv_cache(&mut self) {
    |        ^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:334:8
    |
300 | impl DecoderLayer {
    | ----------------- method in this implementation
...
334 |     fn clear_kv_cache(&mut self) {
    |        ^^^^^^^^^^^^^^

warning: field `sliding_window` is never read
   --> src\qwen.rs:344:5
    |
340 | pub struct Model {
    |            ----- field in this struct
...
344 |     sliding_window: usize,
    |     ^^^^^^^^^^^^^^
    |
    = note: `Model` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:431:12
    |
349 | impl Model {
    | ---------- method in this implementation
...
431 |     pub fn clear_kv_cache(&mut self) {
    |            ^^^^^^^^^^^^^^

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:474:12
    |
444 | impl ModelForCausalLM {
    | --------------------- method in this implementation
...
474 |     pub fn clear_kv_cache(&mut self) {
    |            ^^^^^^^^^^^^^^

warning: `soprano-candle` (bin "soprano-candle") generated 8 warnings
    Finished `release` profile [optimized] target(s) in 37.21s
     Running `target\release\soprano-candle.exe --prompt "hello world!"`
Using device: Cpu
Loading tokenizer...
Loading Qwen model...
Loading Vocos model...
Generating tokens...
Prompt tokens: [3, 1, 8077, 8070, 8045, 8004, 8053, 8076, 8139, 8005, 2]
Generating tokens (this may take a while)...
DEBUG: Hidden states shape: [1, 11, 512]
DEBUG: Hidden states at last position (first 10): [-0.23600166, 0.95291877, -0.27345368, -0.38878685, -0.4340747, -1.2991865, 0.5617781, 0.6938202, -0.03743372, -0.5303086]
DEBUG: Hidden states range: [-8.0287, 9.2031]
Extracting audio codes...
Decoding audio...
DEBUG_RUST_INPUT shape: [1, 512, 50]
DEBUG_RUST_INPUT tail: [0.8384728, 0.7054851, -0.14364402, 0.53745985, 0.75706977, 0.7850623, 1.6852521, 1.075742, 0.8246902, 1.4374981]
DEBUG_RUST_INTERP shape: [1, 512, 197]
DEBUG_RUST_INTERP tail: [1.2281195, 1.075742, 1.012979, 0.9502161, 0.88745314, 0.8246902, 0.97789216, 1.1310942, 1.2842962, 1.4374981]
DEBUG_RUST_BACKBONE shape: [1, 512, 197]
DEBUG_RUST_BACKBONE head: [0.20885974, -0.80196655, -0.12810934, -0.4289754, -0.12678736, -1.8583097, -0.61289763, -0.9072922, -0.37226892, 0.35539758]
DEBUG_RUST_BACKBONE tail: [-1.5248172, -1.5765632, -1.8713231, -1.8603569, -2.0422795, -2.0250537, -2.1862967, -2.3777874, -0.5713297, -1.5753905]
DEBUG_RUST_MAG shape: [1, 1025, 197]
DEBUG_RUST_MAG head: [1.2466991, 1.1523198, 1.3786395, 1.3036363, 1.1616659, 1.1249989, 1.211213, 1.0188996, 0.8973969, 0.48055258]
DEBUG_RUST_MAG tail: [1.0383036, 1.171802, 1.1703601, 1.3698629, 1.3318062, 1.4471338, 1.448883, 1.225063, 0.8866879, 1.0103443]
DEBUG_RUST_PHASE shape: [1, 1025, 197]
DEBUG_RUST_PHASE head: [0.21716556, 0.23765573, 0.46606866, 0.56347173, 0.26736915, 0.55666983, 0.1659712, 0.21703234, 0.4170117, 0.5647364]
DEBUG_RUST_PHASE tail: [-0.08282696, -0.04412233, -0.10142128, -0.08811101, -0.11203888, -0.05912365, -0.19150086, -0.6298478, -0.45458892, -0.21464686]
DEBUG_RUST_IRFFT_FRAME0_SCALED head: [0.00010230638, 0.00013456655, 0.00019155057, 8.777235e-5, 0.00015265463, 0.00019267721, 0.00024636183, 0.00018299569, 0.00013839899, 0.00013051255]
DEBUG_RUST_IRFFT_FRAME0_SCALED tail: [0.0001736074, 0.00019139709, 0.0002208376, 0.00021301117, 7.610832e-5, 0.00016580745, 0.00019448058, 6.175738e-5, 0.00014480323, 8.599516e-5]
DEBUG_RUST_FINAL_AUDIO shape: [100352]
DEBUG_RUST_FINAL_AUDIO head: [-0.00016746821, -0.00016939957, -0.000181787, -0.0001577815, -0.00017749115, -0.00017364636, -0.00017288046, -0.00016380964, -0.0001681578, -0.0001617476]
DEBUG_RUST_FINAL_AUDIO tail: [0.023427658, 0.023545355, 0.024202475, 0.024708597, 0.025478018, 0.025920926, 0.026752513, 0.027226346, 0.02792844, 0.028322428]
Audio stats: len=100352, min=-0.3946, max=0.5248
Generated tokens: [7392, 4555, 7468, 3648, 1448, 840, 521, 138, 139, 203, 267, 203, 139, 1675, 1675, 1739, 147, 75, 4819, 7435, 2523, 6060, 7540, 7868, 5432, 6699, 7333, 7996, 7989, 7679, 6721, 1921, 1843, 6713, 3516, 316, 252, 188, 253, 189, 125, 4924, 7102, 6783, 6785, 4865, 4866, 4867, 3265, 115]
Saving to output.wav...
Done!
