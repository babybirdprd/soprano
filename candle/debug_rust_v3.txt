   Compiling soprano-candle v0.1.0 (D:\soprano\candle)
warning: unused variable: `b`
   --> src\vocos.rs:454:10
    |
454 |     let (b, c, t) = x.dims3()?;
    |          ^ help: if this is intentional, prefix it with an underscore: `_b`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `c`
   --> src\vocos.rs:454:13
    |
454 |     let (b, c, t) = x.dims3()?;
    |             ^ help: if this is intentional, prefix it with an underscore: `_c`

warning: unused variable: `hidden_dim`
   --> src\main.rs:220:9
    |
220 |     let hidden_dim = generated_hidden_states[0].dim(0)?;
    |         ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_hidden_dim`

warning: unused variable: `hidden_tensor`
   --> src\main.rs:222:9
    |
222 |     let hidden_tensor = hidden_tensor.unsqueeze(0)?.transpose(1, 2)?.contiguous()?; // (1, H, L) as expected by Vocos (B, C, T)
    |         ^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_hidden_tensor`

warning: variable does not need to be mutable
   --> src\main.rs:235:9
    |
235 |     let mut audio_vec = _audio_vec;
    |         ----^^^^^^^^^
    |         |
    |         help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` (part of `#[warn(unused)]`) on by default

warning: type `ConvNeXtBlock` is more private than the item `VocosBackbone::convnext`
   --> src\vocos.rs:110:5
    |
110 |     pub convnext: Vec<ConvNeXtBlock>,
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ field `VocosBackbone::convnext` is reachable at visibility `pub(crate)`
    |
note: but type `ConvNeXtBlock` is only usable at visibility `pub(self)`
   --> src\vocos.rs:19:1
    |
 19 | struct ConvNeXtBlock {
    | ^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(private_interfaces)]` on by default

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:287:8
    |
161 | impl Attention {
    | -------------- method in this implementation
...
287 |     fn clear_kv_cache(&mut self) {
    |        ^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:334:8
    |
300 | impl DecoderLayer {
    | ----------------- method in this implementation
...
334 |     fn clear_kv_cache(&mut self) {
    |        ^^^^^^^^^^^^^^

warning: field `sliding_window` is never read
   --> src\qwen.rs:344:5
    |
340 | pub struct Model {
    |            ----- field in this struct
...
344 |     sliding_window: usize,
    |     ^^^^^^^^^^^^^^
    |
    = note: `Model` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:431:12
    |
349 | impl Model {
    | ---------- method in this implementation
...
431 |     pub fn clear_kv_cache(&mut self) {
    |            ^^^^^^^^^^^^^^

warning: method `clear_kv_cache` is never used
   --> src\qwen.rs:474:12
    |
444 | impl ModelForCausalLM {
    | --------------------- method in this implementation
...
474 |     pub fn clear_kv_cache(&mut self) {
    |            ^^^^^^^^^^^^^^

warning: `soprano-candle` (bin "soprano-candle") generated 11 warnings (run `cargo fix --bin "soprano-candle"` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 38.52s
     Running `target\release\soprano-candle.exe --prompt "hello world!"`
Using device: Cpu
Loading tokenizer...
Loading Qwen model...
Loading Vocos model...
Generating tokens...
Prompt tokens: [3, 1, 8077, 8070, 8045, 8004, 8053, 8076, 8139, 8005, 2]
Generating tokens (this may take a while)...
DEBUG: Hidden states shape: [1, 11, 512]
DEBUG: Hidden states at last position (first 10): [-0.23600166, 0.95291877, -0.27345368, -0.38878685, -0.4340747, -1.2991865, 0.5617781, 0.6938202, -0.03743372, -0.5303086]
DEBUG: Hidden states range: [-8.0287, 9.2031]
Extracting audio codes...
Decoding audio (DEBUG: using ones tensor)...
DEBUG_RUST_INPUT shape: [1, 512, 10]
DEBUG_RUST_INPUT tail: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
DEBUG_RUST_INTERP shape: [1, 512, 37]
DEBUG_RUST_INTERP tail: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
DEBUG_RUST_BACKBONE shape: [1, 512, 37]
DEBUG_RUST_BACKBONE head: [-0.924589, -0.8408259, -1.17625, -1.4809909, -1.4657948, -1.4658785, -1.4002123, -1.3919425, -1.3879342, -1.3878598]
DEBUG_RUST_BACKBONE tail: [0.43862456, 0.45192847, 0.617016, 0.6441826, 0.33908764, 0.37120667, 0.56447935, 1.1753678, 0.64369035, -0.9225032]
DEBUG_RUST_MAG shape: [1, 1025, 37]
DEBUG_RUST_MAG head: [0.8886004, 0.75968987, 0.8378972, 0.861982, 0.8241966, 0.80187637, 0.77928126, 0.7762846, 0.7751563, 0.7751295]
DEBUG_RUST_MAG tail: [1.0285671, 1.0288606, 1.0406826, 1.0692074, 1.1558946, 1.0991063, 1.0621052, 0.64526904, 1.0433758, 1.09285]
DEBUG_RUST_PHASE shape: [1, 1025, 37]
DEBUG_RUST_PHASE head: [0.47841424, 0.52650356, 0.5853968, 0.57891643, 0.6049733, 0.6134044, 0.6118612, 0.61255836, 0.6123915, 0.6123865]
DEBUG_RUST_PHASE tail: [-0.17577463, -0.17980173, -0.2113804, -0.0965611, -0.04225593, -0.054668024, -0.30310577, -0.0760508, -0.059656233, 0.11303392]
DEBUG_RUST_IRFFT_FRAME0_SCALED head: [-0.035605233, -0.04459936, -0.0022980422, -0.028918728, 0.026520334, 0.06210494, -0.010822196, -0.046475984, -0.0549223, -0.12116859]
DEBUG_RUST_IRFFT_FRAME0_SCALED tail: [0.075139605, 0.026475435, -0.039169885, -0.045313008, -0.064462446, -0.02832377, 0.0258561, -0.0063043423, 0.0028978214, 0.0332564]
DEBUG_RUST_FINAL_AUDIO shape: [18432]
DEBUG_RUST_FINAL_AUDIO head: [0.118022226, 0.12723924, 0.12084842, 0.111264065, 0.096629396, 0.07653177, 0.065181196, 0.04622652, 0.047044653, 0.042148694]
DEBUG_RUST_FINAL_AUDIO tail: [-0.006991156, -0.001758809, 0.002039844, 0.0033079614, 0.008370349, 0.010286164, 0.0115332985, 0.01124193, 0.011840182, 0.014537199]
Audio stats: len=18432, min=-0.1558, max=0.1382
Generated tokens: [7392, 5450, 6623, 7938, 3228, 6992, 4647, 5748, 6716, 7356, 7660, 7356, 7292, 7668, 7676, 7988, 7996, 7932, 6396, 4796, 3196, 1597, 1598, 1599, 1600, 1600, 1601, 1537, 1536, 1473, 1409, 1345, 1025, 1024, 1016, 1015, 1327, 1383, 1438, 1367, 1303, 1288, 968, 1287, 1032, 967, 1352, 1031, 1030, 1093, 1094, 1158, 837, 836, 772, 2692, 5316, 5188, 5140, 255, 4051, 7727, 7858, 6127, 7712]
Saving to output.wav...
Done!
